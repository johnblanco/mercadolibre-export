import download
import json


def test_car_mapping():
    item = json.loads(
        '{"id":"MLU480867981","site_id":"MLU","title":"Chevrolet Prisma Ltz 2015 Gris Oscuro 4 Puertas","seller":{"id":482008596,"permalink":"http://perfil.mercadolibre.com.uy/SILCASA","registration_date":"2019-10-21T14:34:48.000-04:00","car_dealer":true,"real_estate_agency":false,"tags":["car_dealer","messages_as_seller","messages_as_buyer"],"car_dealer_logo":"https://resources.mlstatic.com/classifieds_accounts/MLU_car_dealer/482008596_vip.jpg","home_image_url":"https://resources.mlstatic.com/classifieds_accounts/MLU_car_dealer/482008596_home.jpg","seller_reputation":{"transactions":{"total":0,"canceled":0,"period":"historic","ratings":{"negative":0,"positive":0,"neutral":0},"completed":0},"power_seller_status":null,"metrics":{"claims":{"rate":0,"value":0,"period":"365 days"},"delayed_handling_time":{"rate":0,"value":0,"period":"365 days"},"sales":{"period":"365 days","completed":0},"cancellations":{"rate":0,"value":0,"period":"365 days"}},"level_id":null}},"price":12500,"prices":{"id":"MLU480867981","prices":[{"id":"1","type":"standard","conditions":{"context_restrictions":[],"start_time":null,"end_time":null,"eligible":true},"amount":12500,"regular_amount":null,"currency_id":"USD","exchange_rate_context":"DEFAULT","metadata":{},"last_updated":"2021-07-22T20:52:42Z"}],"presentation":{"display_currency":"USD"},"payment_method_prices":[],"reference_prices":[],"purchase_discounts":[]},"sale_price":null,"currency_id":"USD","available_quantity":1,"sold_quantity":0,"buying_mode":"classified","listing_type_id":"gold_premium","stop_time":"2021-08-23T23:15:30.000Z","condition":"used","permalink":"https://auto.mercadolibre.com.uy/MLU-480867981-chevrolet-prisma-ltz-2015-gris-oscuro-4-puertas-_JM","thumbnail":"http://http2.mlstatic.com/D_983635-MLU46838506404_072021-I.jpg","thumbnail_id":"983635-MLU46838506404_072021","accepts_mercadopago":false,"installments":null,"address":{"state_id":"TUxVUE1PTlo2MDIy","state_name":"Montevideo","city_id":"TUxVQ01PTjc2Nzc","city_name":"Montevideo","area_code":"","phone1":""},"shipping":{"free_shipping":false,"mode":"not_specified","tags":[],"logistic_type":"not_specified","store_pick_up":false},"seller_address":{"id":"","comment":"","address_line":"","zip_code":"","country":{"id":"UY","name":"Uruguay"},"state":{"id":"UY-MO","name":"Montevideo"},"city":{"id":"TUxVQ1RSRTg3OGM3","name":"Tres Cruces"},"latitude":"","longitude":""},"seller_contact":{"contact":"Silca - Casa Central 2","other_info":"Lun. a Vie. de 9 a 18:30 hs. Sáb. de 10 a 13:30 hs","area_code":"","phone":"","area_code2":"","phone2":"","email":"","webpage":"www.silca.com.uy"},"location":{"address_line":"","zip_code":"","subneighborhood":null,"neighborhood":{"id":"","name":""},"city":{"id":"TUxVQ01PTjc2Nzc","name":"Montevideo"},"state":{"id":"TUxVUE1PTlo2MDIy","name":"Montevideo"},"country":{"id":"UY","name":"Uruguay"},"latitude":-34.90111,"longitude":-56.16453},"attributes":[{"name":"Condición del ítem","value_id":"2230581","value_name":"Usado","value_struct":null,"attribute_group_id":"","source":1,"id":"ITEM_CONDITION","values":[{"struct":null,"source":1,"id":"2230581","name":"Usado"}],"attribute_group_name":""},{"id":"TRACTION_CONTROL","value_id":"-1","attribute_group_name":"Adicionales","source":6822533571418751,"name":"Control de tracción","value_name":null,"value_struct":null,"values":[{"id":"-1","name":null,"struct":null,"source":6822533571418751}],"attribute_group_id":"ADICIONALES"},{"values":[{"struct":null,"source":6822533571418751,"id":"242085","name":"Sí"}],"attribute_group_id":"CONFORT","attribute_group_name":"Confort","name":"Aire acondicionado","value_struct":null,"value_name":"Sí","source":6822533571418751,"id":"HAS_AIR_CONDITIONING","value_id":"242085"},{"id":"ACCELERATION_GASOLINE","name":"Aceleración nafta","value_id":"-1","attribute_group_id":"DFLT","attribute_group_name":"Otros","source":6822533571418751,"value_name":null,"value_struct":null,"values":[{"id":"-1","name":null,"struct":null,"source":6822533571418751}]},{"attribute_group_id":"DFLT","source":6822533571418751,"value_struct":null,"values":[{"id":"-1","name":null,"struct":null,"source":6822533571418751}],"attribute_group_name":"Otros","id":"AUTONOMY_GASOLINE","name":"Autonomía con nafta","value_id":"-1","value_name":null},{"id":"AVERAGE_FUEL_ENCONOMY_GASOLINE","values":[{"name":null,"struct":null,"source":6822533571418751,"id":"-1"}],"attribute_group_name":"Otros","name":"Consumo promedio nafta","value_id":"-1","value_name":null,"value_struct":null,"attribute_group_id":"DFLT","source":6822533571418751},{"value_id":"-1","values":[{"name":null,"struct":null,"source":6822533571418751,"id":"-1"}],"id":"CYLINDERS","value_name":null,"value_struct":null,"attribute_group_id":"DFLT","attribute_group_name":"Otros","source":6822533571418751,"name":"Cilindros"},{"id":"ENGINE_DISPLACEMENT","value_struct":{"number":1400,"unit":"cc"},"attribute_group_name":"Otros","source":6822533571418751,"name":"Cilindrada","value_id":null,"value_name":"1400 cc","values":[{"name":"1400 cc","struct":{"number":1400,"unit":"cc"},"source":6822533571418751,"id":null}],"attribute_group_id":"DFLT"},{"value_struct":null,"values":[{"source":6822533571418751,"id":"-1","name":null,"struct":null}],"attribute_group_id":"DFLT","attribute_group_name":"Otros","id":"LENGTH","name":"Largo","value_name":null,"value_id":"-1","source":6822533571418751},{"source":6822533571418751,"value_struct":null,"values":[{"id":"-1","name":null,"struct":null,"source":6822533571418751}],"attribute_group_id":"DFLT","value_name":null,"attribute_group_name":"Otros","id":"MAXIMUM_VELOCITY_GASOLINE","name":"Velocidad máxima con nafta","value_id":"-1"},{"value_id":"-1","value_name":null,"values":[{"source":6822533571418751,"id":"-1","name":null,"struct":null}],"source":6822533571418751,"id":"PASSENGER_CAPACITY","name":"Capacidad de personas","value_struct":null,"attribute_group_id":"DFLT","attribute_group_name":"Otros"},{"id":"POWER","name":"Potencia","value_id":"-1","value_struct":null,"values":[{"id":"-1","name":null,"struct":null,"source":6822533571418751}],"value_name":null,"attribute_group_id":"DFLT","attribute_group_name":"Otros","source":6822533571418751},{"id":"BRAND","value_id":"58955","value_struct":null,"values":[{"id":"58955","name":"Chevrolet","struct":null,"source":6822533571418751}],"attribute_group_name":"Ficha técnica","name":"Marca","value_name":"Chevrolet","attribute_group_id":"FIND","source":6822533571418751},{"id":"DOORS","name":"Puertas","value_id":"60241","value_name":"4","values":[{"id":"60241","name":"4","struct":null,"source":6822533571418751}],"attribute_group_id":"FIND","value_struct":null,"attribute_group_name":"Ficha técnica","source":6822533571418751},{"value_id":"423552","value_name":"1.4","values":[{"struct":null,"source":6822533571418751,"id":"423552","name":"1.4"}],"attribute_group_name":"Ficha técnica","source":6822533571418751,"id":"ENGINE","name":"Motor","value_struct":null,"attribute_group_id":"FIND"},{"id":"FUEL_TYPE","value_struct":null,"values":[{"name":"Nafta","struct":null,"source":6822533571418751,"id":"64364"}],"attribute_group_id":"FIND","name":"Tipo de combustible","value_id":"64364","value_name":"Nafta","attribute_group_name":"Ficha técnica","source":6822533571418751},{"attribute_group_id":"FIND","id":"KILOMETERS","value_name":"57778 km","value_struct":{"number":57778,"unit":"km"},"values":[{"id":null,"name":"57778 km","struct":{"number":57778,"unit":"km"},"source":6822533571418751}],"attribute_group_name":"Ficha técnica","source":6822533571418751,"name":"Kilómetros","value_id":null},{"value_name":"Prisma","attribute_group_name":"Ficha técnica","source":6822533571418751,"value_struct":null,"values":[{"id":"194417","name":"Prisma","struct":null,"source":6822533571418751}],"attribute_group_id":"FIND","id":"MODEL","name":"Modelo","value_id":"194417"},{"attribute_group_name":"Ficha técnica","value_name":"Manual","values":[{"name":"Manual","struct":null,"source":6822533571418751,"id":"370877"}],"value_id":"370877","value_struct":null,"attribute_group_id":"FIND","source":6822533571418751,"id":"TRANSMISSION","name":"Transmisión"},{"value_id":null,"value_name":"LTZ","value_struct":null,"values":[{"id":null,"name":"LTZ","struct":null,"source":6822533571418751}],"attribute_group_id":"FIND","attribute_group_name":"Ficha técnica","id":"TRIM","name":"Versión","source":6822533571418751},{"value_struct":null,"source":6822533571418751,"attribute_group_name":"Ficha técnica","id":"VEHICLE_YEAR","name":"Año","value_id":"423549","value_name":"2015","values":[{"source":6822533571418751,"id":"423549","name":"2015","struct":null}],"attribute_group_id":"FIND"}],"original_price":null,"category_id":"MLU1744","official_store_id":null,"domain_id":"MLU-CARS_AND_VANS","catalog_product_id":"MLU8817997","tags":["good_quality_picture"],"order_backend":1,"use_thumbnail_id":true}')
    car = download.map_car(item)

    assert car['price'] == 12500
    assert car['used']
    assert car['engine_displacement'] == 1400
    assert car['year'] == '2015'
    assert car['brand'] == 'Chevrolet'
    assert car['model'] == 'Prisma'
    assert car['doors'] == '4'
    assert car['permalink'] == 'https://auto.mercadolibre.com.uy/MLU-480867981-chevrolet-prisma-ltz-2015-gris-oscuro-4-puertas-_JM'
